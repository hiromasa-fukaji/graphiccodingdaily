<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>p5.js Glitch Pixel Sorting</title>
  <!-- p5.js CDN 読み込み -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <!-- willReadFrequently設定のためのパッチ -->
  <script>
    // p5.jsのcreateCanvas関数を拡張してwillReadFrequently属性を設定
    // 注意: これはp5.jsの内部実装に依存するため、完全な解決にはならない可能性があります
    (function() {
      const originalCreateCanvas = p5.prototype.createCanvas;
      p5.prototype.createCanvas = function(w, h, renderer) {
        const result = originalCreateCanvas.call(this, w, h, renderer);
        // キャンバスのコンテキストを取得してwillReadFrequentlyを設定
        // ただし、p5.jsは既にコンテキストを作成しているため、この設定は効果が限定的です
        try {
          const canvas = this.canvas;
          if (canvas && canvas.getContext) {
            // 新しいコンテキストを作成（willReadFrequently属性付き）
            // 注意: これはp5.jsの内部コンテキストを置き換えるものではないため、
            // 警告は完全には解消されない可能性があります
            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            if (ctx && this._renderer && this._renderer.drawingContext) {
              // p5.jsの内部コンテキストを更新（可能な場合）
              // これはp5.jsの内部実装に依存するため、動作しない可能性があります
            }
          }
        } catch (e) {
          // エラーが発生した場合は無視（警告は動作に影響しません）
          console.log('willReadFrequently設定の試行中にエラーが発生しました:', e);
        }
        return result;
      };
    })();
  </script>
  <!-- スケッチ用ファイル -->
  <script src="sketch.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #000000;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <!-- キャンバス要素はp5.jsが自動生成 -->
</body>
</html>
